# Social Media API Service

> Documentation of socialmedia api service

## Requirements

| Name | Version |
|------|---------|
|golang| >= 1.18 |
|mysql | >= 8.0  |

## Introduction

***English***:

socialmedia is a api that represents an Social Media application, you can:

    1. Creates an account (with login and password);
    2. Create a publication;
    3. Follow/Unfollow an User;
    4. See yours or someonelses publication;
    5. See who liked your publication.

***Portugues***:

socialmedia é uma aplicação que representa uma Rede Social, você pode:

    1. Criar uma conta (com login e senha);
    2. Criar uma publicação;
    3. Seguir/Deixar de Seguir um usuário;
    4. Ver a suas publicações ou as publicações de alguém;
    5. Ver quem curtiu a sua publicação.

No diretório `./src` possui os **packages** da aplicação

No diretório `./assets` possui arquivos/imagens relacionados a documentação da API.

No diretório `./sql` possui scripts para testar a aplicação localmente.

## Application Instrumentation

***Portugues***:

No endpoint `/metrics` a API expoem metricas no formato do Prometheus para que um certo **scraper** venha realizar a coleta das mesmas.

Atualmente a instrumentação da aplicação provê visões de regras de negócio que serão listadas abaixo e visões **default** vindas da própria biblioteca do Prometheus:

```
# HELP created_publications_total Quantity Of Publications Created
# TYPE created_publications_total counter
created_publications_total 2

# HELP deleted_publications_total Quantity Of Publications Deleted
# TYPE deleted_publications_total counter
deleted_publications_total 2

# HELP created_users_total Quantity Of Users Created
# TYPE created_users_total counter
created_users_total 2

# HELP deleted_users_total Quantity Of Users Deleted
# TYPE deleted_users_total counter
deleted_users_total 2

# HELP sm_time_to_create_publication Time took to create a new user
# TYPE sm_time_to_create_publication histogram
sm_time_to_create_publication_bucket{code="200",le="1"} 1
sm_time_to_create_publication_bucket{code="200",le="2"} 1
sm_time_to_create_publication_bucket{code="200",le="5"} 1
sm_time_to_create_publication_bucket{code="200",le="6"} 1
sm_time_to_create_publication_bucket{code="200",le="10"} 1
sm_time_to_create_publication_bucket{code="200",le="+Inf"} 1
sm_time_to_create_publication_sum{code="200"} 2e-07
sm_time_to_create_publication_count{code="200"} 1
```

## Running Localy

Necessary Environment variables:

1. `DB_HOST` Database Address

2. `DB_USER` Database User

3. `DB_PASS` Database Password

4. `DB_NAME` Schema Name

5. `API_PORT` Which Port the API Will Serve and Listen

6. `SECRET_KEY` A Secret Key that JWT will generate and return the api token string generated by the users when authenticating

### **You can simply run it:**

`DB_USER=<DB User>  DB_PASS=<DB Password>  DB_NAME=<Schema Name>  API_PORT=<Which Port Will API Run>  SECRET_KEY=<A Secret Key> go run main.go`

### **Or build and run:**

`GOOS=<Your OS System> GOARCH=<Your Arch> go build -o socialmedia`

`DB_USER=<DB User>  DB_PASS=<DB Password>  DB_NAME=<Schema Name>  API_PORT=<Which Port Will API Run>  SECRET_KEY=<A Secret Key> ./socialmedia`

### **On Docker Compose:**

`.env` file is necessary to store passwords

`docker build -t <My Tag>:<My Version> .`

`docker-compose up -d`

### **On Kubernetes:**

Soon..

## API Endpoints

See:

`src/swagger/swagger.json` file to understand the requests and responses

## License

socialmedia is licensed under the Apache License, Version 2.0. See
[LICENSE](https://github.com/danilo-lopes/socialmedia/blob/main/LICENSE) for the full
license text.